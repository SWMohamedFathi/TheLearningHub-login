<app-sidebar></app-sidebar>

<div class="col-lg-8 d-flex align-items-stretch" style="width: 60%; font-size: 15px;margin-left: 285px;overflow-x: hidden;">
  <div class="card w-100">
    <div class="card-body p-4">
      <h3 class="card-title fw-semibold mb-4">All Courses</h3>
      <br>
      <input type="text" [(ngModel)]="_filterText" >
      <button mat-button (click)="OpenCreateDialog()">Create New</button>
      <div class="table-responsive">
        <table class="table text-nowrap mb-0 align-middle" id="table-data">
          <thead class="text-dark fs-4">
            <tr>
              <th class="border-bottom-0">
                <h4 class="fw-semibold mb-0">Category Name</h4>
              </th>
              <th class="border-bottom-0">
                <h4 class="fw-semibold mb-0">Course Name</h4>
              </th>
              <th class="border-bottom-0">
                <h4 class="fw-semibold mb-0">Start Date</h4>
              </th>
              <th class="border-bottom-0">
                <h4 class="fw-semibold mb-0">End Date </h4>
              </th>
       

              <th class="border-bottom-0">
                  <h4 class="fw-semibold mb-0">Image</h4>
                </th>
              <th class="border-bottom-0">
                <h4 class="fw-semibold mb-0">Operation</h4>
              </th>
            </tr>
          </thead>
        
          <tbody>

            <ng-container *ngFor="let obj of home.cat_Courses">
            <tr *ngFor="let course of obj.courses |filter :_filterText">

              <td>{{obj.categoryname}}</td>
              <td>{{course.coursename| lowercase}}</td> 
              <td>{{course.startDate}}</td>
              <td>{{course.endDate|date : 'longDate'}}</td>
              <!-- <td>{{course.price}}</td> -->
              <td> <img src="../../../assets/Images/{{course.imagename}}"> </td>
              

        <td>
                  <button type="button" class="btn btn-primary m-1" (click)="openUpdateDailog(course)" >Update</button>

                  <button type="button" (click)="DeleteCourse(course.courseid)" class="btn btn-danger m-1">Delete</button>
              </td>
            </tr>    </ng-container> 
          </tbody>
        </table>
      </div>
    </div>
  </div>
<h2>The number of courses : {{this.home.numberOfActiveCourse}}</h2>


  <ng-template #callDeleteDailog>

    <h1 mat-dialog-title>Delete Course </h1>
<div mat-dialog-content>Are you sure you want to delete this item ?</div>
<div mat-dialog-actions>
  <button type="button" class="btn btn-primary m-1" mat-dialog-close="1">Yes</button>
  <button type="button" mat-button mat-dialog-close="0">No</button>
</div>
 </ng-template>

 <ng-template  #callUpdateDialog>
  <h2 mat-dialog-title>Update Course </h2>
<mat-dialog-content class="mat-typography">
    <form class="example-form" [formGroup]="updateForm">
        <mat-form-field class="example-full-width">
          <mat-label>Course Name</mat-label>
          <input type="text" matInput formControlName="coursename" [(ngModel)]="pData.coursename">
          <mat-error *ngIf="updateForm.controls['coursename'].hasError('required')">
            Course Name is <strong>required</strong>
          </mat-error>
        </mat-form-field>
    
        <mat-form-field class="example-full-width">
            <mat-label>Price</mat-label>
            <input type="number" matInput formControlName="price" [(ngModel)]="pData.price">
            <mat-error *ngIf="updateForm.controls['price'].hasError('required')">
             Price is <strong>required</strong>
            </mat-error>
          </mat-form-field>
    
          <mat-form-field class="example-full-width">
            <mat-label>Start Date</mat-label>
            <input type="date" matInput formControlName="startDate" [(ngModel)]="pData.startDate">
            <mat-error *ngIf="updateForm.controls['startDate'].hasError('required')">
                Start date is <strong>required</strong>
            </mat-error>
          </mat-form-field>
    
          <mat-form-field class="example-full-width">
            <mat-label>End Date</mat-label>
            <input type="date" matInput formControlName="endDate" [(ngModel)]="pData.endDate">
            <mat-error *ngIf="updateForm.controls['endDate'].hasError('required')">
                End date is <strong>required</strong>
            </mat-error>
          </mat-form-field>
          
          <div>
            <input type="file" #file formControlName="imagename"
             (change)="uploadImage(file.files)" > 
          </div>

      </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cancel</button>
  <button mat-button [mat-dialog-close]="true" cdkFocusInitial (click)="UpdateCourse()">update</button>
</mat-dialog-actions>




 </ng-template>
